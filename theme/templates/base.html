{% load static %}
<!DOCTYPE html>
<html lang="en">
    {% load django_bootstrap5 %}
    <head>
        <meta charset="UTF-8"/>
        <title>e-footprint</title>
        <link rel="stylesheet" href="{% static 'css/bs_main.css' %}"/>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link rel="icon" type="image/x-icon" href="/static/icons/sidenav/logo.svg"/>
        <link rel="stylesheet" href="{% static 'css/main.css' %}"/>
        <script src="{% static 'scripts/external_librairies/htmx.min.js' %}"></script>
        <script src="{% static 'scripts/external_librairies/_hyperscript.min.js' %}"></script>
        <script src="{% static 'scripts/external_librairies/leader-line.min.js' %}"></script>
        <script src="{% static 'scripts/external_librairies/Sortable.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.5.0/build/global/luxon.min.js"></script>
    <script src=" https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@^1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/2.2.0/chartjs-plugin-zoom.min.js" integrity="sha512-FRGbE3pigbYamZnw4+uT4t63+QJOfg4MXSgzPn2t8AWg9ofmFvZ/0Z37ZpCawjfXLBSVX2p2CncsmUH2hzsgJg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="{% static 'scripts/usage_pattern_modal_controller.js' %}"></script>
    <script src="{% static 'scripts/form_timeseries_controller.js' %}"></script>
    <script src="{% static 'scripts/timeseries.js' %}"></script>

</head>

    <body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
        <div class="container-fluid p-0">
            <!-- Main Content -->

            <main id="main-content-block" class="text-center w-100" style="height: 95vh;">
                {% if home %}
                {% include "home.html" %}
                {% elif understand %}
                {% include "understand.html" %}
                {% elif modelBuilderMain %}
                {% include "model_builder/model_builder_main.html" %}
                {% endif %}
            </main>
        </div>
    {% bootstrap_javascript %}
        <script src="{% static 'scripts/leaderline_utils.js' %}"></script>
        <script src="{% static 'scripts/dynamic_forms.js' %}"></script>
        <script src="{% static 'scripts/loading_bar.js' %}"></script>
        <script src="{% static 'scripts/modal_utils.js' %}"></script>
        <script src="{% static 'scripts/side_panel_utils.js' %}"></script>
        <script src="{% static 'scripts/result_chart.js' %}"></script>
        <script src="{% static 'scripts/model_builder_main.js' %}"></script>
        <script>
            window.initModelBuilderMain = initModelBuilderMain;
            window.allLines = new Map();

            document.body.addEventListener('initModelBuilderMain', function (event) {
               window.initModelBuilderMain();
            });

            window.addEventListener("load", function () {
                if (window.location.pathname === "/model_builder/") {
                    window.initModelBuilderMain();
                }
            });

            document.body.addEventListener("computeResultChart", function(event) {
                let modalElement = document.getElementById("resultModal");
                let modal = new bootstrap.Modal(modalElement);
                modal.show();
                drawAreaResultChart()
                updateAreaResultChart('bar', 'year');
            });
        </script>
    </body>
</html>
